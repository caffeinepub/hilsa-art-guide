{
  "kind": "build_request",
  "title": "Replace pencil sketch stages with portrait drawing stages and update style",
  "projectName": "HILSA Art Guide",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-5",
      "text": "Update the five drawing stage definitions throughout the app to: 1) Trace the outlines of the portrait, 2) Draw the basic elements, 3) Have a slight shading, 4) Render and detail, 5) Polish. Replace all references to the old pencil sketch stage names (Construction Lines, Contour Outline, etc.) with these new stage labels everywhere they appear — including stage labels, captions, progress indicators, the GalleryView, the Drawing Guide walkthrough, and the HowItWorks page timeline.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "stages : 1. Trace the outlines of the portrait 2. Draw the basic elements 3. Have a slight shading 4. Render and detail 5. Polish"
        ]
      },
      "acceptanceCriteria": [
        "Stage 1 is labelled 'Trace the outlines of the portrait' everywhere in the UI",
        "Stage 2 is labelled 'Draw the basic elements' everywhere in the UI",
        "Stage 3 is labelled 'Have a slight shading' everywhere in the UI",
        "Stage 4 is labelled 'Render and detail' everywhere in the UI",
        "Stage 5 is labelled 'Polish' everywhere in the UI",
        "No old pencil sketch stage names (Construction Lines, Contour Outline, Basic Shading, Detail Pass, Final Render, etc.) remain visible anywhere in the UI",
        "GalleryView step labels reflect the new stage names",
        "HowItWorks page timeline reflects the new stage names",
        "Drawing Guide walkthrough stage titles and captions reflect the new stage names"
      ]
    },
    {
      "id": "REQ-6",
      "text": "Update the client-side image processing pipeline in pencilSketchUtils.ts to produce outputs that visually match each new stage style: Stage 1 produces a faint outline/trace style, Stage 2 produces basic structural elements with clean lines, Stage 3 adds light shading/tonal values, Stage 4 adds rendered detail and texture, Stage 5 produces a polished, refined final illustration. Replace the current uniform pencil-sketch filter approach with per-stage visual treatments that progressively build toward a finished portrait illustration.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "ue these styles insted of te pencil sketch"
        ]
      },
      "acceptanceCriteria": [
        "Each of the 5 stages produces a visually distinct output that matches its stage description",
        "Stage 1 output shows only faint traced outlines",
        "Stage 2 output shows basic elements with clean line work",
        "Stage 3 output shows visible light shading added over stage 2",
        "Stage 4 output shows detailed rendering and texture",
        "Stage 5 output looks polished and refined compared to stage 4",
        "The pipeline processes a user-uploaded image and returns 5 progressive canvas data URLs"
      ]
    },
    {
      "id": "REQ-7",
      "text": "Update the instructional captions for each stage throughout the app (GalleryView per-stage captions, Drawing Guide captions, HowItWorks descriptions) to match the new stage names and styles: Stage 1 — tracing outlines, Stage 2 — drawing basic elements, Stage 3 — applying slight shading, Stage 4 — rendering and detailing, Stage 5 — polishing the portrait.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "stages : 1. Trace the outlines of the portrait 2. Draw the basic elements 3. Have a slight shading 4. Render and detail 5. Polish"
        ]
      },
      "acceptanceCriteria": [
        "Each stage has an updated instructional caption relevant to its new name and technique",
        "HowItWorks page technique notes are updated to reflect the new five stages",
        "GalleryView per-stage captions are updated",
        "Drawing Guide walkthrough captions are updated"
      ]
    },
    {
      "id": "REQ-8",
      "text": "Update the backend stage processing pipeline definitions in main.mo to reflect the five new stage names: Trace Outlines, Basic Elements, Slight Shading, Render and Detail, Polish — replacing any stored pencil sketch stage identifiers or labels used in job status tracking and stage results.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-latest"
        ],
        "quotes": [
          "stages : 1. Trace the outlines of the portrait 2. Draw the basic elements 3. Have a slight shading 4. Render and detail 5. Polish"
        ]
      },
      "acceptanceCriteria": [
        "Backend stage identifiers or labels match the five new stage names",
        "Job status and stage result records use the updated stage names",
        "Existing CRUD operations and rate limiting logic are not broken"
      ]
    }
  ],
  "constraints": [
    "Do not modify files listed in frontend.immutablePaths (useInternetIdentity, useActor, main.tsx, components/ui)",
    "Preserve existing job management CRUD operations and rate limiting logic in the backend",
    "The five stage count must remain exactly five"
  ],
  "nonGoals": [
    "Adding new pages or routes beyond what already exists",
    "Changing the overall app branding or color theme",
    "Integrating external AI image generation APIs",
    "Changing the upload or job creation flow"
  ],
  "imageRequirements": {
    "required": [
      "Portrait drawing stage 1 illustration — faint outline trace of a face on white background, minimal marks (stage1-trace-outlines.dim_600x600.png)",
      "Portrait drawing stage 2 illustration — clean line drawing of basic facial elements on white background (stage2-basic-elements.dim_600x600.png)",
      "Portrait drawing stage 3 illustration — line drawing with light pencil shading over facial planes on white background (stage3-slight-shading.dim_600x600.png)",
      "Portrait drawing stage 4 illustration — detailed rendered portrait with tonal depth and texture on white background (stage4-render-detail.dim_600x600.png)",
      "Portrait drawing stage 5 illustration — polished, refined finished portrait drawing on white background (stage5-polish.dim_600x600.png)"
    ],
    "edits": []
  }
}